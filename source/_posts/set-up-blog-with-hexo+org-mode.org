#+TITLE: set-up-blog-with-hexo+org-mode
#+AUTHOR: weychen
#+EMAIL: weychen@163.com
#+DATE: 2016-09-28
#+LAYOUT: post
#+OPTIONS: ^:nil
#+TAGS: how-to-blog
#+CATEGORIES: emacs
#+DESCRIPTON: hexo+org-modeæ­å»ºè‡ªå·±çš„åšå®¢ç³»ç»Ÿ
* ä¸ºä»€ä¹ˆæœ‰è¿™ä»½æ•™ç¨‹
  å­¦ä¹ emacsï¼Œè¢«emacsçš„org-modeæ‰€æ·±æ·±å¸å¼•ï¼Œæˆ‘ä¹Ÿå¼€å§‹å…¥å‘ï¼Œæ—©å°±æƒ³ç€è¦å†™åšå®¢ï¼Œäºæ˜¯ä¹æˆ‘é€‰æ‹©äº†æ¯”è¾ƒæµè¡Œå’Œå¥½ç”¨çš„hexoã€‚
  å½“æˆ‘å¼€å§‹æ­å»ºæˆ‘çš„åšå®¢ç¯å¢ƒçš„æ—¶å€™ï¼Œå‘ç°ç½‘ä¸Šå‡ ä¹æ²¡æœ‰ä¸€ä»½æ¸…æ™°å®Œæ•´çš„æ•™ç¨‹æ¥æŒ‡å¯¼æˆ‘çš„å·¥ä½œï¼Œæˆ‘ä¸œæ‹¼è¥¿å‡‘ï¼Œæ‘¸ç€çŸ³å¤´è¿‡æ²³ï¼Œè‡ªå·±èŠ±äº†è¿‘ä¸¤å¤©çš„æ—¶å€™ç»ˆäºæ­å»ºå¥½äº†æˆ‘çš„ç¯å¢ƒã€‚
æ‰€ä»¥æˆ‘æƒ³å†™è¿™æ ·çš„ä¸€ä»½æ•™ç¨‹ï¼Œä»–æ˜¯é¢å¯¹emacså…¥é—¨ç”¨æˆ·çš„ï¼Œå¦‚æœä½ åƒæˆ‘ä¸€æ ·ï¼Œåˆšåˆšå…¥é—¨emacsï¼Œè‡ªå·±åˆå–œæ¬¢å†™blogï¼Œå¹¶ä¸”é™·å…¥emacsçš„org-modeæ‰€å¸¦æ¥çš„æƒŠå–œè€Œæ— æ³•è‡ªæ‹”
é‚£ä¹ˆï¼Œè¿™ç¯‡æ–‡ç« åº”è¯¥èƒ½å¸®åˆ°ä½ ã€‚
#+BEGIN_HTML
<!--more-->
#+END_HTML
* hexo å®‰è£…
  å…³äºè¿™ä¸€éƒ¨åˆ†çš„æ“ä½œï¼Œæœ‰å¾ˆå¤šå‰äººç»™æˆ‘ä»¬ç•™ä¸‹äº†å®è´µçš„ç»éªŒã€‚
  [[http://lovenight.github.io/2015/11/10/Hexo-3-1-1-%25E9%259D%2599%25E6%2580%2581%25E5%258D%259A%25E5%25AE%25A2%25E6%2590%25AD%25E5%25BB%25BA%25E6%258C%2587%25E5%258D%2597/][Hexo 3.1.1 é™æ€åšå®¢æ­å»ºæŒ‡å— | å²æœˆå¦‚æ­Œ]]
* emacs å¯¹äºhexo çš„æ”¯æŒ
  è¿™é‡Œä¸»è¦æ˜¯ä¸¤ä¸ªä¸œè¥¿ï¼šblog-admin å’Œ hexo-renderer-orgã€‚
  æˆ‘çš„é…ç½®å‚è€ƒï¼š[[http://blog.pschorf.com/blog/2016/02/28/spacemacs-blogging/][Blogging in Spacemacs - pschorf's blog]]
** blog-admin
  ä¸‹é¢æ˜¯æˆ‘çš„é…ç½®ï¼š
  #+BEGIN_SRC lisp
(defun org-page/init-blog-admin ()
  (use-package blog-admin
    :config (progn (setq blog-admin-backend-type 'hexo   ;; åå°ç±»å‹
                         blog-admin-backend-path "~/org/blog"                ;; hexo åšå®¢æ‰€åœ¨è·¯å¾„
                         blog-admin-backend-new-post-in-drafts t             ;; é»˜è®¤åœ¨draftsåˆ›å»ºæ–‡ç« 
                         blog-admin-backend-new-post-with-same-name-dir nil  ;; é»˜è®¤ä¸åˆ›å»ºç›¸åº”çš„ç›®å½•ï¼Œå› ä¸ºæˆ‘ç›®å‰æ²¡æœ‰å‘ç°è¿™ä¸ªç›®å½•çš„ä½œç”¨ï¼Œå…ˆå¹²æ‰ 
                         ;; blog-admin-backend-org-page-drafts "_drafts"     ;;
                         blog-admin-backend-hexo-config-file "_config.yml"   ;; hexo é…ç½®æ–‡ä»¶
                         )
                   ;; (evilified-state-evilify-map blog-admin-mode-map :mode blog-admin-mode)
                   (spacemacs/set-leader-keys
                     "abb" 'blog-admin-start)                    ;; ç»‘å®šspaceå¿«æ·é”®
                   (add-hook 'blog-admin-backend-after-new-post-hook 'find-file) ;; Open post after create new post
                   (setq blog-admin-backend-hexo-template-org-post  ;; postæ¨¡æ¿
                         "#+TITLE: %s
                         #+AUTHOR: weychen
                         #+EMAIL: weychen@163.com
                         #+DATE: %s
                         #+LAYOUT: post
                         #+TAGS:
                         #+CATEGORIES:
                         #+DESCRIPTON:
                         ")
                         )))
  #+END_SRC
  è¯´æ˜ï¼šæˆ‘ä½¿ç”¨çš„æ˜¯spacemacsï¼Œå…³äºä¸ºä»€ä¹ˆä½¿ç”¨spacemacsï¼Œè¿™é‡Œä¸åšè¯¦ç»†å™è¿°ã€‚ä¸Šè¿°çš„ä»£ç é…ç½®æˆ‘æ”¾åœ¨æˆ‘è‡ªå®šä¹‰çš„"org-page"å±‚ä¸­ï¼Œspacemacså…è®¸æˆ‘ä»¬å®šä¹‰è‡ªå·±çš„layerã€‚
** hexo-renderer-org
   è¿›å…¥hexo åšå®¢çš„æ ¹ç›®å½•ï¼Œåœ¨æˆ‘çš„ç³»ç»Ÿä¸­æ˜¯"~/org/blog"ï¼Œå®‰è£…hexo-renderer-org
   #+BEGIN_SRC shell
   npm install hexo-renderer-org --save
   #+END_SRC
   ç„¶ååœ¨ä½ çš„hexoé…ç½®æ–‡ä»¶:```_config.yml```ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š
   #+BEGIN_SRC conf
org:
  emacs: '/Applications/Emacs.app/Contents/MacOS/Emacs'
  common: |
          #+OPTIONS: toc:nil
          #+BIND: org-html-postamble \"Last Updated %C.</br>Render by <a href='https://github.com/CodeFalling/hexo-renderer-org'>hexo-renderer-org</a> with %c\"
  cachedir: './hexo-org-cache/'
   #+END_SRC
   å…¶ä¸­çš„OPTIONS é€‰é¡¹æ˜¯é’ˆå¯¹orgå¯¼å‡ºä¸ºHTMLæ‰€åšçš„ä¸€äº›é€‰é¡¹çº¦æŸï¼Œtocçš„æ„æ€æ˜¯å¯¼å‡ºæ—¶ä¸ºæ¯ä¸ªæ ‡é¢˜ç¼–åºå·ã€‚
   BINDæ˜¯å¯¼å‡ºçš„æœ€åº•å±‚æ˜¾ç¤ºçš„ä¸œè¥¿ï¼Œä¸Šè¿°çš„ä»£ç çš„å°†ä¸€æ®µhtmlä»£ç èµ‹å€¼ç»™org-html-postambleå˜é‡ã€‚
   read more æ ‡ç­¾ï¼šå°†ä¸‹è¿°çš„ä»£ç æ”¾ç½®åœ¨ä½ çš„orgæ–‡ä»¶ä¸­ï¼Œå°†åœ¨ä½ çš„blogä¸­æ˜¾ç¤ºä¸º<é˜…è¯»æ›´å¤š>ã€‚
   #+BEGIN_SRC lisp
#+BEGIN_HTML
<!--more-->
#+END_HTML
   #+END_SRC

* å›¾ç‰‡ä¸Šä¼ 
  åšå®¢çš„å›¾ç‰‡æˆªå›¾æˆ‘å‚è€ƒäº†"å­é¾™å±±äºº"çš„é…ç½®--[[https://zilongshanren.com/blog/2015-07-19-add-org-mode-support.html#orgheadline9][ä½¿ç”¨ Org-mode æ¥å†™åšå®¢ | å­é¾™å±±äºº]]ï¼Œä»–è¿™ç¯‡æ–‡ç« ä¸­æ‰€å®šåˆ¶çš„æˆªå›¾åŠŸèƒ½çš„å°å‡½æ•°ååˆ†åœ°å®ç”¨ã€‚
  åšå®¢çš„å›¾ç‰‡å­˜å‚¨æˆ‘ä½¿ç”¨çš„æ˜¯ä¸ƒç‰›äº‘å­˜å‚¨ï¼Œç½‘ä¸Šä¹Ÿæœ‰ä¸å°‘çš„æ•™ç¨‹æ˜¯ä½¿ç”¨qrsyncè¿™ä¸ªå·¥å…·çš„ï¼Œqrsyncæ˜¯ä¸ƒç‰›å‡ºå“çš„ä¸€ä¸ªåŒæ­¥å·¥å…·ï¼Œç°åœ¨å·²ç»åºŸå¼ƒï¼Œä¸ƒç‰›å¼€å‘å›¢é˜Ÿæ¨èç”¨qshellæ¥æ›¿ä»£qrsync
ä¸ƒç‰›å¼€å‘è€…ä¸­å¿ƒç»™å‡ºäº†ã€‚åœ¨ä¸ƒç‰›å¼€å‘è€…ä¸­å¿ƒç»™å‡ºäº†è¯¦ç»†çš„è¯´æ˜æ–‡æ¡£:[[http://o9gnz92z5.bkt.clouddn.com/code/v6/tool/qshell.html][qshell å‘½ä»¤è¡Œå·¥å…·]]ï¼Œæˆ‘é‡‡ç”¨å…¶ä¸­çš„qshell quploadå‘½ä»¤ã€‚
  æˆ‘é’ˆå¯¹qshellä¸­çš„quploadå®šåˆ¶äº†ä¸€ä¸ªemacs elispå‡½æ•°:
  #+BEGIN_SRC lisp
(defun octopress-qrsync (command)
  (let ((command-str (format "~/bin/qshell qupload %s" command))) ;; è°ƒç”¨qshell qupload command
    (shell-command-to-string command-str)))
(defun octopress-upimg ()
  (interactive)
  (octopress-qrsync "~/org/blog/images/posts/conf.json")          ;; qshell qupload æ‰€éœ€è¦çš„ä¸Šä¼ é…ç½®æ–‡ä»¶
  (message "Up OK"))
  #+END_SRC
  åœ¨emacsä¸­æ‰§è¡Œoctopress-upimgå°†è‡ªåŠ¨ä¸Šä¼ ~/org/blog/images/postsæ–‡ä»¶å¤¹ä¸­çš„æ–‡ä»¶ã€‚
* Conclusion
  é€šè¿‡è¿™ä¸¤å¤©çš„ç¢ç£¨ï¼Œæ„Ÿè§‰è‡ªå·±å¯¹äºemacsçš„ä½¿ç”¨ç†Ÿæ‚‰äº†ä¸å°‘ï¼Œé‡åˆ°é—®é¢˜ï¼Œä¹ŸçŸ¥é“äº†è¯¥æ€ä¹ˆå»è§£å†³äº†ã€‚
  å­¦ä¹ emacsä¸€å®šè¦æ‹¿ä¸Šæ¥å°±ç”¨ï¼Œä¸è¦è¯´å…ˆå»å­¦æ‡‚lispè¯­è¨€å†æ¥ä½¿ç”¨emacsï¼Œè¿™æ ·å­¦ä¹ æˆæœ¬å¤ªé«˜ï¼Œä¹Ÿæ²¡æœ‰å…´è¶£ã€‚å…´è¶£æ‰æ˜¯æœ€å¥½çš„è€å¸ˆï¼Œä½•å†µæˆ‘ä»¬ç°åœ¨çš„å­¦ä¹ ä¸åƒé«˜ä¸­é‚£èˆ¬æœ‰è€å¸ˆçš„ç£ä¿ƒï¼Œ
æœ‰åŒå­¦çš„ç›¸äº’æ¿€åŠ±ï¼Œæ²¡æœ‰å¸¦ç€å…´è¶£å»å­¦ä¹ ä¸€é—¨æŠ€æœ¯ï¼Œæ— æ³•åšæŒä¸€ä¸ªæ˜ŸæœŸã€‚
* Reference
  - 1.[[http://lovenight.github.io/2015/11/10/Hexo-3-1-1-%25E9%259D%2599%25E6%2580%2581%25E5%258D%259A%25E5%25AE%25A2%25E6%2590%25AD%25E5%25BB%25BA%25E6%258C%2587%25E5%258D%2597/][â€œHexo 3.1.1 é™æ€åšå®¢æ­å»ºæŒ‡å— | å²æœˆå¦‚æ­Œâ€]] 
  - 2.[[https://zilongshanren.com/blog/2015-07-19-add-org-mode-support.html][â€œä½¿ç”¨ Org-mode æ¥å†™åšå®¢ | å­é¾™å±±äººâ€ğŸ”Š]]
  - 3.[[http://blog.pschorf.com/blog/2016/02/28/spacemacs-blogging/][Blogging in Spacemacs - pschorf's blog]]
  - 4.[[https://github.com/CodeFalling/blog-admin][CodeFalling/blog-admin: Write blog in emacs with hexo/org-page/nikola]]
  - 5.[[https://github.com/weychen/hexo-renderer-org][weychen/hexo-renderer-org: Hexo renderer plugin for emacs org-mode]]
  - 6.[[https://github.com/qiniu/qshell/wiki/qupload][qupload Â· qiniu/qshell Wiki]]
